import numpy as np
import pywt
import cv2
from skimage.transform import rotate
from skimage.util import random_noise
#from imblur import motion_blur
from scipy import signal
#from skimage.measure import structural_similarity as ssim
from skimage.measure import compare_ssim as ssim
#from pyblur import *

def im2double(im):
	return cv2.normalize(im.astype('float'), None, 0.0, 1.0, cv2.NORM_MINMAX)
def mse(x, y):
    return np.linalg.norm(x - y)
def sharpen(im):
    kernel = np.array([[-1,-1,-1], [-1,9,-1], [-1,-1,-1]])
    return cv2.filter2D(im, -1, kernel)
def motion_blur(img):
    size = 15
    kernel_motion_blur = np.zeros((size, size))
    kernel_motion_blur[int((size-1)/2), :] = np.ones(size)
    kernel_motion_blur = kernel_motion_blur / size
    return cv2.filter2D(img, -1, kernel_motion_blur)
#k = [   2.0382427,     2.95824859,    2.58912847,    6.91894981, -191.27753531,3.10135338,    2.11346944,    3.75585795,    3.98646551,    4.34503435,7.81200784,    5.31903991,    7.70891728,    6.12347944,    1.78066036,5.06109275,    3.11655177,    8.94397692,    1.63663601,    3.40018171,3.31667473,    7.06509175,    1.70697642,    2.93186839,    2.86248103,9.79197514,    8.63280109,    3.32014951,    2.66976251,    3.01008289,9.36483673,    9.15069361,    4.25645453,    4.4603994,     7.30141092,4.04697866,    2.09520328,    3.5891721,     9.29898718,    3.12065652,9.29438434,    7.40431374,    2.09461415,    4.42290625,    4.27739154,1.58956257,5.38769795,    2.38131597,    3.76155494,    1.1771233,5.542208,      2.38248272,    4.91254338,    4.55946972,    6.89750387,4.95664504,    9.88193003,    5.65076353,    7.79249233,    1.70455157,7.16768616    ,1.29257968    ,3.99986146    ,7.84643663]
#k=[   2.11534069,    1.62274845,    1.55005917,    4.21434511, 4.21897082,3.62592493,    2.5493771,     5.9023978,     5.63617473,    9.24005793,5.12550117,    4.93086865,    5.19958018,    9.5299243,     4.29420408,2.574833,      7.0378514,    6.25955227,    4.92316571,    2.30771534,2.26180635,    7.03539921,    9.63297297,    2.34769444,    7.83652031,6.4040311,     6.91202097,    3.93796339,    2.62366774,    8.9593147,9.53032125,    7.39246186,    9.52426244,    8.7509535,     8.59497141,5.46893682,    1.92334118,    5.42019964,    3.79860971,    8.94613859,6.46519971,    2.4287295,     2.547578,      4.98082972,    9.02082329,2.25343961,    8.05840906,    8.83987784,    7.55656931,    5.79825844,4.25122687,    1.05438821,    6.53273163,    8.47659113,    8.51629751,6.60831219,    9.04243821,    1.02906911,    9.35193899,    8.32611924,8.1685111,     6.55787143,    3.32811187,    5.9376211, ]
#k=[ 1.51046873e+00,  1.74143437e+00,  6.21105926e-01,  7.57756137e-01,-1.85489143e+02,  4.15272970e+00,  7.43379785e-01,  6.11945969e+00,6.32050399e+00,  1.53337925e-01,  6.64555889e-01,  7.50488903e+00,6.44682569e-01,  6.97476495e+00,  6.47298262e+00,  5.89221232e+00,2.06535533e+00,  4.67383116e-01,  8.39044498e-01,  4.77601875e-01,5.76698249e+00,  4.15547533e+00,  2.53497491e+00,  9.73885315e-01,7.32286512e+00,  5.57922631e+00,  6.35828744e+00,  4.55017583e+00,5.25363721e+00,  3.41391962e+00,  5.62837450e+00,  1.11586520e-01,2.47210572e+00,  1.88101290e+00,  3.17949160e+00,  4.08061109e+00,3.65069872e+00,  4.56638521e+00,  1.64453204e+00,  3.97716401e+00,2.00828072e+00,  5.50905250e+00,  6.88118416e+00, 5.38949763e+00,6.38196626e+00,  2.62128008e+00,  3.67500908e+00,  1.72611809e+00,6.45309202e-02,  2.51308594e+00,  7.10318955e+00,  4.96431571e+00 ,4.87424946e+00,  4.33534440e-01,  5.76789813e+00,  6.71197233e-011,45047626e+00,  3.27948225e+00,  3.82705054e+00,  3.61930791e+00, 2.26792484e-01,  2.46246406e+00,  5.39739518e+00,  4.06252386e-02]
#k=[1818.62717528808,932.424802459934,1392.29458094861,1391.13828488233,1901.55547368055,1876.64333069999,1794.59561208845,1916.90701109138,1822.87279355287,1903.27230522488,1921.37171211426,1856.94600785084,1871.18564241964,1894.10063202108,1880.62794609556,1746.54271678675,1827.64218751970,1884.37907019012,1894.97255656941,1807.51853014932,1898.68006007071,1852.81702331491,1829.88343493454,1912.06493974101,1917.19545288598,1922.48898037739,1923.57688677063,1913.09141104009,1915.24997267629,1903.16060811551,1858.04202528026,1892.69805783657]
#k=[1.8340971974432712, 8.147593046774087, 6.630235927501817, 5.85189068411585, 4.8044735686722175, 6.557465080275829, 6.120694410775569, 4.205331125196269, 5.226881011697675, 4.733100061398467, 6.262259858202323, 4.4127687312866275, 4.58161247305241, 2.5966430230557167, 2.306688202895164, 4.839103762898533, 5.630787055082777, 3.5861977728881587, 6.1934092795976685, 6.384698010251916, 5.549498086837806, 4.529247271022309, 4.492724402301866, 6.942583533147453, 7.743833581977869, 2.6161282814425295, 2.8775942430229784, 6.560527618416758, 5.058220688852217, 4.239784877890976, 6.199022662844103, 4.4880887006111605, 3.7783219615131793, 3.4178505671733075, 6.837846532192707, 6.527535459402626, 4.456983995105128, 4.793175434171657, 6.548010539197725, 6.170996789320986, 4.146537356886773, 4.676952128156739, 5.910471447711865, 4.769520612137483, 3.7886454267369634, 7.299790116363878, 5.017960292756532, 6.275514493190572, 4.231666353802281, 6.146352013189814, 3.114061451632947, 4.394373326941629, 3.804135290975952, 4.646915071676957, 5.929742380016509, 5.557596390201964, 5.68934245251085, 2.754001384733983, 7.346934264071505, 5.64340395734305, 6.283067476412483, 5.710956860772021, 4.667335429319024, 5.056865194483114]
#k=[-7.80453283e-01, 4.42691849e-02,  3.47609016e+00, -1.07964342e+00, -1.90734531e+02,  4.03514090e-01, -3.54994582e+00, -5.39389181e-01, 1.19374442e+00, -1.27717600e+00,  3.81080808e+00,  2.37212661e+00, 9.11155364e-01, -3.83331130e+00, -2.98097008e+00,  1.02444687e+00, 2.16558890e+00, -2.96075028e+00,  3.03485638e-01, -1.79477132e+00, -2.80311093e+00,  9.12864232e-02, -1.28038408e+00, -3.53821622e+00, 1.97665917e+00, -2.37094512e+00, -1.35999305e+00,  1.32458115e+00, 3.98670467e-01,  1.12848386e+00,  8.50411838e-01, -2.36251862e+00, -2.97414999e+00,  3.87242195e+00, -4.77285010e-01, -1.79835589e+00, -7.50885014e-01, -1.98184054e+00,  3.46996756e+00, -2.53713095e+00, 3.75381462e+00, -6.54351981e-01, -1.78454903e+00, -1.26594650e+00, -1.64036928e+00, -1.85539709e+00,  2.75331230e+00, -3.42756139e+00, 2.85837610e+00, -2.27101944e+00, -2.61394410e-01, -3.84391826e+00, -8.91916603e-01, -3.92549515e+00, -2.33990588e+00, -3.80167067e+00, 3.44156631e+00,  3.68486266e-01,  3.72757147e+00,  5.88413650e-01, -8.99847625e-01, -2.58513537e+00, -2.18885646e+00, -2.18897028e+00]
#k=[ 2.00278396e+00, -6.65661343e-01, -5.71291203e-02,  9.47278138e-01, 4.75714241e-01, -4.06612855e-03,  6.57872348e-01,  4.20995069e+00, 7.31815601e+00, -5.35386601e-01,  5.03377286e+00,  3.75829195e+00, -5.78723258e-01,  2.72093067e+00, -6.34710417e-01, -6.29858774e-01, -9.75094583e-01,  2.67414464e+00,  4.76955293e+00,  5.92458685e+00, 3.75256714e+00,  5.41034630e+00,  5.22076638e+00,  6.50120257e+00, 2.07389317e+00,  5.05898051e+00,  1.66359318e+00,  3.80590529e+00, 3.98416908e+00, -8.12287452e-01,  3.25446404e+00,  3.59492796e+00, 3.51286624e+00,  5.39043929e+00,  6.69349212e+00,  3.99744337e-01, 5.63934627e+00,  3.07337620e+00,  2.38269901e+00,  3.98932327e+00, -9.65084220e-01,  4.41054260e-01,  7.79335650e+00, -6.40187843e-01, 3.27446091e+00,  4.22776725e+00,  4.36254101e+00,  4.09023243e+00, 5.11364709e-01,  4.93088183e+00,  1.00001320e+00,  7.07992905e+00, 1.08374801e+00,  5.56918182e+00,  4.06212988e-01,  8.99403118e-01, 3.62089618e+00,  4.26064897e+00,  8.41599273e-01,  5.35869634e+00, 3.71380096e+00,  5.84421279e+00,  4.33120825e+00, -8.11701908e-01
#k=[1.8340971974432712, 8.147593046774087, 6.630235927501817, 5.85189068411585, 4.8044735686722175, 6.557465080275829, 6.120694410775569, 4.205331125196269, 5.226881011697675, 4.733100061398467, 6.262259858202323, 4.4127687312866275, 4.58161247305241, 2.5966430230557167, 2.306688202895164, 4.839103762898533, 5.630787055082777, 3.5861977728881587, 6.1934092795976685, 6.384698010251916, 5.549498086837806, 4.529247271022309, 4.492724402301866, 6.942583533147453, 7.743833581977869, 2.6161282814425295, 2.8775942430229784, 6.560527618416758, 5.058220688852217, 4.239784877890976, 6.199022662844103, 4.4880887006111605, 3.7783219615131793, 3.4178505671733075, 6.837846532192707, 6.527535459402626, 4.456983995105128, 4.793175434171657, 6.548010539197725, 6.170996789320986, 4.146537356886773, 4.676952128156739, 5.910471447711865, 4.769520612137483, 3.7886454267369634, 7.299790116363878, 5.017960292756532, 6.275514493190572, 4.231666353802281, 6.146352013189814, 3.114061451632947, 4.394373326941629, 3.804135290975952, 4.646915071676957, 5.929742380016509, 5.557596390201964, 5.68934245251085, 2.754001384733983, 7.346934264071505, 5.64340395734305, 6.283067476412483, 5.710956860772021, 4.667335429319024, 5.056865194483114]
'''k=[   5.86145376,    9.16517768  ,  9.10746616,    9.97898359, -193.83877334,
      4.38979531,    5.80252849,    9.17349884,    9.67422146,    2.26115664
      ,3.68099376,    7.44915434,    3.93146078,    2.80274823,    7.30031958
      ,3.11360829,    6.74685934,    9.93402225,    5.29309998,    7.10247659
      ,1.2779551,     2.86653744,    4.29247697,    3.54276943,    4.71485462
      ,2.76934496,    3.45755294,    1.18506805,    6.26780626,    8.06077806
      ,1.832165  ,    7.88698157,    2.57494186,    7.46417756,    8.07475295
      ,8.34495281,    9.84900613,    2.73806776,    8.76369055,    7.30925926
      ,1.01246866,    3.29669415,    9.33039467,    5.83702802,    7.68049257
      ,8.51323336,    1.33848574,    6.09381823,    2.57718164,    7.71882789
      ,9.11557053,    6.30440012,    7.55780859,    1.49589606,    1.14737244
      ,9.94331843,    9.0196672,     7.59640519,    9.08488418,    9.46730759
      ,6.90957127,    3.66885058,    9.65552299    ,6.16997301]
'''
k= [   5.90228645,   8.90633236,    2.56509908,   6.80166879,    1.24456602,
      1.66628348,    1.84381395,    1.93278531,   5.3546159,     7.55530175,
      8.32618562,    4.54956721,    1.03434266,    9.22956138,    3.59344085,
      8.77967488,    5.98540245,    3.46379978,    3.412634,      5.68969576,
      5.18336317,    6.81220487,    1.61739887,    7.35374323,    1.42857772,
      4.56799172,    4.672838  ,    7.40128361,    1.96432935,    7.57372638,
      3.52661925,    6.55656343,    8.62998973,    1.29047835,    1.31544505,
      6.43977807,    3.41305315,    1.68471075,    1.51693259,    8.08374656,
      6.43994644,    1.03057896,   2.56618033,    5.28430218,    2.72346375,
      5.22899782,    4.98348458,    9.04104148,    8.81102407,    6.73436873,
      4.86186814,    7.27419405,    2.2552319,     4.55142861,    2.62317107,
      5.58407896,    8.7579442,     8.8974974,     9.00780329,    1.94697399,
      3.07570245,    3.63949736 ,   1.02310879, -375.53286866]
#k=[ 1.430911759441662, 1.558950032606254, 7.800431873283101, 2.667480478965920, 2.584260764888120, 7.867593672477344, 0.999674458095757, 5.237469704819397, 3.603200646893012, 5.810723859188290, 3.444542187015887, 8.855827808525712, 6.715029663879999, 2.268745629551113, 2.590147510172441, 6.151012665836328, 3.574428564635912, 9.949206181720040, 4.425431038447866, 0.295062426225503, 7.550346295461786, 1.236884409521272, 3.648956451275302, 0.073076118869840, 1.118068027482950, 0.755448674340555, 6.068636002902920, 2.826496572943940, 2.657244218393551, 0.650195739065412, 7.566678588502436, 7.583032505978444, 8.743321729789583, 2.860885113008117, 6.939244734422699, 5.798106303102256, 3.586893453210629, 9.156045871695294, 5.202574102748613, 3.521705770523622, 2.092518278782211, 3.323705073499844, 1.182641151599493, 8.973501086874423, 6.768335460529753, 4.083976888365388, 7.875142782018435, 2.229164771314544, 0.992663825582847, 5.720354899720610, 8.547636229791655, 6.751595635043279, 6.624870823173975, 2.235931438955142, 1.733541336655056, 6.499509080249472, 2.861810956687946, 9.541985946937428, 4.290032722530917, 5.500788954052550, 0.693581019040523, 8.561466051408232, 1.146610648270882, 1.644806827877461 ]
#k=[2.181078937972103, 7.190685665518993, 6.618509088441475, 5.555152318796333, 5.536773464216335, 5.4117327836858005, 5.9990023436644355, 8.324345206478467, 4.659195708305155, 5.765472328923189, 3.7842276136439255, 5.762929139951887, 4.549053194356847, 4.0373137139254505, 3.8737255148541943, 4.203792230318159, 5.013756105023798, 5.109482107568161, 3.432535192511786, 6.254697689097618, 4.815718305777316, 4.16723362609227, 2.395490571200516, 5.007274170743683, 4.690250601320077, 3.825344423615546, 2.429194040397576, 1.8848991034433908, 2.4147926523043277, 4.399221821010228, 2.915428618343995, 3.076626290052005, 8.414814769720184, 5.066691435884508, 1.990099681705917, 5.329636049981486, 2.8501328167194107, 6.688089876696746, 5.451725208920768, 5.060366023790865, 3.8111173352628134, 4.28668905533297, 4.65048303304806, 3.1680902320300595, 4.552306709723044, 9.114608315984654, 3.9932311687676845, 3.965585492169771, 10, 2.7996055205829884, 8.025423054337981, 7.0832991271506325, 3.727419164754687, 7.867377826109683, 5.372245176076169, 5.461726306056812, 3.5727368298537745, 3.3409094301158433, 6.1705491432382615, 3.2108723635177823, 3.5854427421160158, 2.2672118225833144, 5.0654431854154724, 4.747797520321118]
#k= [  9.41,  8.85,  1.04,  0.21,  7.48,  9.88,  3.54,  5.17,  7.36,  5.11,  9.95,  6.37,  0.57,  8.78,  3.28,  5.73,  7.47,  1.19,  4.62,  1.33,  3.88,  0.91,  1.93,  5.96,  1.72,  7.11,  9.34,  8.86,  2.87,  1.92,  1.49,  7.36,  9.01,  6.60,  4.30,  6.04,  1.47,  4.46,  4.98,  3.99,  1.73,  0.21,  0.96,  4.16,  0.44,  0.13,  8.55,  5.98,  0.39,  9.07,  1.75,  2.25,  4.43,  0.67,  2.40,  1.36,  4.75,  3.47,  1.93,  5.67,  5.70,  3.28,  0.27,  1.76 ]
#k= [ 6.190725441394726, 2.972561437609381, 1.452664689072498, 8.032226119094958, 0.996241006215124, 3.689242473329957, 4.631506144204989, 2.144550478833450, 5.638986588419076, 4.781831198082862, 0.832734229340303, 1.445724645247876, 7.246311481725600, 7.091064682125884, 2.675909375751593, 2.416961598505133, 9.339511964471184, 3.156363735455092, 8.791074088037400, 0.123190382442802, 2.593372134359217, 0.062968039779285, 8.809023867844960, 7.863387850875700, 4.045915172016301, 1.730981078213525, 3.816215725878890, 3.298216246216481, 1.180405636217012, 9.599182815746824, 6.225244831593559, 0.196400262743626, 5.422018866025482, 4.887804418871577, 2.496355295040764, 2.996778171443494, 9.645078022447542, 9.662686823692406, 9.978754797342615, 1.003787966213131, 8.884295888304148, 0.923617885798012, 5.609185649009554, 8.690095562017383, 3.668872863341525, 4.815898784363504, 9.396258149421076, 2.952449122862018, 2.961488189969582, 4.600004687988499, 1.820200432947757, 4.275900725035623, 9.187317277469578, 0.550679652420145, 3.321284978075691, 4.970795231415357, 8.239202602371615, 0.366415357883602, 5.785619721723274, 6.806881397826321, 9.265513012450725, 4.695353546564601, 7.701937090925574, 1.122633741006561 ]
#k=[ 5.216394730021010, 8.920153386641157, 4.887339804768595, 1.156339663095105, 4.615080461906716, 0.306299214483498, 4.100738311059775, 1.693065372053341, 8.473579919348589, 4.972139605960902, 1.943226994983437, 1.319944494665354, 5.629841048228847, 4.187764248905309, 6.817650749358250, 5.229234631122289, 4.468516655550836, 2.945688610992758, 2.150889877707998, 9.534927494155740, 9.330228920655220, 5.427506174353971, 4.885842200206794, 3.538562033766697, 0.408868448658518, 7.003709195149614, 8.186476219498539, 3.058394404859612, 0.616501357094855, 3.802977554865040, 1.183864223180888, 4.993189447738232, 2.600963481327193, 2.340320239734239, 8.413339549802663, 7.356158888743427, 6.765617614428272, 4.343890184538409, 3.085251230043784, 9.881925342890941, 0.588841236602897, 0.800369049878799, 5.393755111714023, 3.735423202793748, 7.249643885506067, 3.668010812356005, 2.268646755207353, 0.663792098219872, 6.859547407961170, 3.431279998521568, 3.714639039980276, 8.549130830137967, 6.368336679856602, 5.384203131741111, 1.326005248254934, 5.321165451070105, 7.029254203056725, 4.315924109920664, 5.067516957661554, 9.535407605332226, 4.710332467938717, 4.648535345194028, 9.026733609584264, 9.776131077313941 ]

#k=[ 7.213849053955768, 2.047814998260669, 2.115651035824536, 5.129037618378751, 9.280076977708307, 1.236912168913633, 5.527132306245778, 0.537743765418118, 6.438445794176197, 5.989577038667353, 1.552326281187322, 1.808540933264295, 3.078521766732844, 2.262823014609650, 5.210454571184242, 7.082785131549648, 4.565670657078642, 7.134511834805846, 7.067146325313102, 5.696514268910756, 5.639853383785622, 7.036312419734055, 9.118987096595550, 6.771569932448347, 7.972207397347820, 2.200549043511938, 4.175047692039863, 3.544605409859002, 3.359148988983740, 2.044552447848245, 1.913390480194129, 1.575656041295284, 8.722881660909481, 6.051978424338007, 3.518999877946718, 8.525885041413924, 5.841756137039310, 0.297627767042875, 5.994246366756535, 5.826564674898215, 9.960469444735905, 8.007001451380209, 2.233523700540212, 4.283606957713141, 5.586878579550642, 9.184830261319796, 2.418373700089718, 8.761469832123982, 8.592649030200445, 7.863815994938765, 7.520035479413311, 5.354574070342776, 5.006426213480585, 1.750012854243809, 1.642949896431956, 0.435324304958437, 6.870521953543035, 1.187675465081411, 4.854295088147660, 5.858488858969522, 0.937675484786792, 9.222282876788469, 0.868573748281002, 7.410888540284260 ]
#k=[ 3.244628000154735, 6.208619344758822, 1.240389830910369, 8.855239370829901, 6.281764870307732, 5.225948262921259, 6.333547668475901, 2.121005484526570, 9.230477360688322, 0.697890684368593, 5.789877592509262, 6.915195693108211, 2.857235731039625, 7.073170296450332, 7.109406880447797, 3.428471716330320, 6.222477419543138, 6.588457503226400, 6.413791762677938, 5.386159548077178, 0.866370587640689, 6.509455016777441, 3.463880994611914, 3.490811132797025, 3.811050134700115, 0.476931885890709, 8.840382071393801, 9.545068844704742, 3.040939566787096, 3.195050048535919, 9.430173695010337, 4.968637892058311, 5.333516314177881, 2.355392842475391, 6.168853763687051, 0.623838203319810, 5.986549296897140, 7.365613515520419, 2.471986090559844, 1.234083991225915, 1.034247908302998, 3.433529386759804, 3.683168166963907, 8.654399919047382, 8.311529734156032, 5.543536102465120, 5.667779348579209, 3.875883780701570, 9.604111464068449, 2.104559832641558, 0.333986355643802, 7.612765012724188, 8.640551387320464, 2.772859707613078, 5.812756114592483, 5.921339818357445, 9.295381121610069, 1.670354794848254, 8.014500031114807, 4.007628996565108, 5.582791056835573, 3.555734567218669, 1.515572299477947, 0.887470383819423 ]
#k= [ 4.527855520244971, 2.523714357403541, 2.202269030195597, 4.328028479300912, 6.219258641237725, 8.010097077380991, 2.849362937482860, 8.811696023494365, 7.134163348069979, 6.516905683636644, 7.876834001399655, 9.278083395020053, 9.682877575900168, 8.733541800383669, 4.347037591443113, 2.226362699692985, 1.651372231512382, 0.825815479170890, 8.766985362573179, 2.789552911199186, 8.442670965306608, 5.201394775128599, 1.220324011867583, 4.073952115099926, 1.447731903317967, 3.021710514166736, 8.872012654645630, 9.929892975082748, 4.483379895110705, 7.885835492009473, 4.783185310243454, 2.494937224214690, 2.229664945406522, 3.496910605824545, 7.541733568153360, 9.262939102479431, 6.058901573697084, 0.719050056604827, 3.409392797162814, 7.894369657488244, 5.275113448342903, 1.974200241529404, 9.595489268524585, 4.259386982391447, 8.295307668502961, 2.972857165075972, 4.854405654391323, 1.160668535834316, 6.818661347778275, 9.964432380686366, 3.111776359848720, 1.666484544768900, 5.967063612594727, 6.981200419152197, 1.314315676658230, 3.531332724805583, 8.988222835698570, 2.038560454307877, 6.376873188194800, 2.051103605788702, 1.370351532129174, 4.688857886182700, 9.480404154896528, 0.618726285298722]
#k=[ 8.306131943557764, 0.622138712203019, 4.342132139754207, 6.768203952355457, 0.406926406716563, 9.793661822979931, 2.277022097423405, 9.829896304858201, 3.651618833965691, 0.994614100697422, 7.901728201570978, 5.192082307184531, 9.438948270635430, 6.370574244609790, 9.839857626884726, 3.746725283448200, 1.229510483110650, 0.116167824763719, 2.541270852395084, 7.555205096640964, 5.190704272243241, 7.751780556282533, 5.429311617667122, 7.785975059280531, 0.660589997407974, 7.398428454455396, 2.073992680179598, 5.312590813650696, 3.053375357800086, 6.136091357732814, 9.506990793197227, 1.530522277408919, 8.993800682416794, 0.244402314666866, 1.955069971426273, 0.915463800333577, 9.801531528759121, 4.921570787336717, 0.009711552827243, 1.242141057148867, 3.261507213281498, 9.551937791698801, 1.610661017773928, 0.405389518399705, 6.799167344389341, 3.676888761194176, 6.811097477793519, 6.983249939970023, 4.573311490363007, 9.797081372026293, 1.006064526175481, 2.059652421584067, 8.828492913164066, 9.943608233925662, 4.601708953842842, 1.150786642433828, 3.706321115148087, 9.530342136619803, 5.735319365662369, 7.125594122730469, 1.542051617648127, 6.096265580471799, 9.425954279694039, 6.146689932924802 ]

#k=[ 8.184397830698897, 7.292470841533295, 9.303021946724780, 3.830870992087362, 4.594940367827354, 4.398618433324486, 3.246209834322794, 1.981093609324740, 7.473594489826175, 3.603123553182751, 7.082873388788032, 5.403574923572623, 1.687484435188292, 0.173779730704390, 5.961845860723524, 7.215336462259424, 3.678551493490047, 9.306906440183823, 2.861784496089666, 4.219347327421566, 9.603816212668818, 7.525880586556966, 8.880993078859328, 5.163869505838407, 5.753805217987997, 5.187529878454612, 6.690123410397797, 0.499868573761878, 7.271074602971219, 9.094198643892300, 5.876817364072341, 0.893952998394113, 3.175544197683137, 4.668272259094966, 8.658713751325076, 2.798606717739056, 4.568550108845932, 6.333511504991720, 2.655241978791318, 8.159113633244711, 0.111933947572617, 7.771132167880076, 9.652876779460586, 2.113450177916305, 0.027442796255719, 4.772007606983380, 7.892512762332816, 6.797731944944012, 8.346601439037105, 7.154879373515753, 6.665105131290177, 1.199103831531317, 1.712651577864743, 0.001535524439865, 1.734142744993569, 3.959278730252697, 1.817734651238434, 5.897147035232532, 5.084816555922775, 4.273906570624865, 8.166177201496179, 9.070241903961579, 7.652028769000933, 0.288425125342897 ]
#k= [ 3.808031924476412, 4.905633289894038, 5.606562986039249, 9.477380668336805, 4.729474061818541, 5.106578709627670, 0.930798507701935, 1.833451014356337, 0.382815337552550, 3.796769537662156, 6.211333085718175, 2.840788566912835, 5.043257780872836, 6.417803496877000, 4.271540504904140, 5.953788898692869, 3.164314625700607, 3.468142534382479, 6.588902698445209, 2.682889234096975, 4.957016189574928, 9.831381356937859, 4.511844531816855, 2.173239457076829, 4.742255084694831, 3.720903669466803, 5.381623844885609, 1.089261046661885, 3.087192334600168, 1.949875039773851, 6.111407092354733, 6.823861018141438, 6.243116255451322, 3.439183755763511, 6.482796061962559, 0.656066181791407, 0.189839650119006, 8.700986745102400, 1.879202742694946, 8.693258235153300, 8.730399237727775, 7.331644045932224, 0.554022292247021, 0.909245724578144, 2.145200354128170, 8.525835517429392, 3.732683398105844, 5.942340859109789, 3.292651226087646, 9.107368991994658, 5.882104419075703, 9.421920541979290, 3.287995687497034, 2.325926850747918, 4.770208088698644, 6.120071874201578, 3.773035677508819, 8.159222828583331, 0.984464862044294, 7.190089105581939, 2.038147960651180, 3.725658201744032, 9.733287981736876, 6.538649880119473 ]
#k=[ 8.143603136384460, 3.076007781750404, 0.861513722807772, 9.904659217516420, 4.800214492150858, 6.064827109555959, 2.882738767885047, 4.792174834586622, 8.380601291325544, 0.332254835059027, 8.234779656304058, 6.076646750295581, 6.624393676735155, 9.111582546295789, 5.379556276279454, 6.134020205265751, 4.957783860564838, 7.800809256426256, 8.522019382889722, 0.976494363906216, 1.218504552992544, 4.537797561762755, 0.409629241712848, 9.141457456913871, 9.949567912034880, 2.650408143733106, 4.613505075105538, 2.388021177169074, 1.814158667738992, 9.350163573757934, 1.456240775192840, 1.235231889831273, 4.897701831619154, 3.761580736128307, 7.203685013755216, 1.753266135755479, 8.005126257784122, 3.388960346126665, 4.968133982814660, 6.146650739577669, 4.979879498051419, 2.381789722559286, 3.694132396330053, 2.264744549458304, 1.158423233431490, 5.784783887274221, 4.595543190875273, 4.564138930727152, 3.970700108074643, 5.072110925091597, 8.924299185923184, 8.466772092976262, 8.688848279998314, 8.552945225976918, 0.196070072641092, 5.933110627078776, 9.718405070639285, 0.608622757310486, 9.463923007135579, 3.581392116004119, 8.734476954409175, 2.059394958770336, 5.954570724681398, 8.561967827994053 ]
#k= [ 1.430911759441662, 1.558950032606254, 7.800431873283101, 2.667480478965920, 2.584260764888120, 7.867593672477344, 0.999674458095757, 5.237469704819397, 3.603200646893012, 5.810723859188290, 3.444542187015887, 8.855827808525712, 6.715029663879999, 2.268745629551113, 2.590147510172441, 6.151012665836328, 3.574428564635912, 9.949206181720040, 4.425431038447866, 0.295062426225503, 7.550346295461786, 1.236884409521272, 3.648956451275302, 0.073076118869840, 1.118068027482950, 0.755448674340555, 6.068636002902920, 2.826496572943940, 2.657244218393551, 0.650195739065412, 7.566678588502436, 7.583032505978444, 8.743321729789583, 2.860885113008117, 6.939244734422699, 5.798106303102256, 3.586893453210629, 9.156045871695294, 5.202574102748613, 3.521705770523622, 2.092518278782211, 3.323705073499844, 1.182641151599493, 8.973501086874423, 6.768335460529753, 4.083976888365388, 7.875142782018435, 2.229164771314544, 0.992663825582847, 5.720354899720610, 8.547636229791655, 6.751595635043279, 6.624870823173975, 2.235931438955142, 1.733541336655056, 6.499509080249472, 2.861810956687946, 9.541985946937428, 4.290032722530917, 5.500788954052550, 0.693581019040523, 8.561466051408232, 1.146610648270882, 1.644806827877461 ]

k= np.array(k)
a=cv2.imread('lena_gray_512.tif')
a=cv2.cvtColor(a,cv2.COLOR_BGR2GRAY)
a=cv2.resize(a, (512,512))
cv2.imshow('Host Image',a)
cv2.waitKey(2000)
coeffs = pywt.dwt2(a, 'haar')
ll, (lh, hl, hh) = coeffs
llu,lls,llvh =np.linalg.svd(ll,full_matrices=False)

w=cv2.imread('default.jpeg')
w=cv2.cvtColor(w, cv2.COLOR_BGR2GRAY)
w=cv2.resize(w, (64,64))
cv2.imshow('Watermark',w)
cv2.waitKey(2000)
wu,ws,wvh=np.linalg.svd(w,full_matrices=False)

llsm=lls
llsm[0:64]=lls[0:64]+ws*0.001*k
llsm=np.array(llsm)
llsm=np.diag(llsm)
llnew=np.matmul(llu, np.matmul(llsm, llvh))
coeffs2=llnew, (lh, hl, hh)
aw=pywt.idwt2(coeffs2, 'haar')
data=ssim(a,aw)
print(data)
aw=im2double(aw)
#cv2.imshow('OUTPUT',aw)
cv2.waitKey(2000)
cv2.destroyAllWindows()

def switch(num):
    if num == 1:
        aw1=sharpen(aw)
        cv2.imshow('sharpen',aw1)
        return aw1
    elif num == 2:
        aw1 = cv2.resize(aw,None,fx=1.2, fy=1.2, interpolation = cv2.INTER_CUBIC)
        cv2.imshow('scaled',aw1)
        return aw1
    elif num == 3:
        aw1=rotate(aw,45)
        cv2.imshow('rotated',aw1)
        return aw1
    elif num == 4:
        aw1=random_noise(aw, mode='s&p', seed=None, clip=True)
        cv2.imshow('salt and pepper noise',aw1)
        return aw1
    elif num == 5:
        aw1=random_noise(aw, mode='gaussian', seed=None, clip=True)
        cv2.imshow('Gaussian',aw1)
        return aw1
    elif num == 6:
        aw1=motion_blur(aw)
        cv2.imshow('Motion Blur',aw1)
        return aw1
    elif num == 7:
        aw1=cv2.blur(aw,(10,10))
        cv2.imshow('Blurred Image',aw1)
        return aw1
    elif num == 8:
        aw1=np.flip(aw, 0)
        cv2.imshow('Verticle Flip',aw1)
        return aw1
    elif num == 9:
        aw1=np.flip( aw, 1 )
        cv2.imshow('Horizontal Flip',aw1)
        return aw1
    elif num == 10:
        aw1=cv2.blur(aw,(5,5))
        cv2.imshow('Averaging',aw1)
        return aw1
    else:
        print('invalid option')
        quit()

for num in range(1,11):
    aw1=switch(num)
    aw1=aw1*512
    coeffs3 =pywt.dwt2(aw1, 'haar')
    llw, (lhw, hlw, hhw) = coeffs3
    aw1u,aw1s,aw1vh=np.linalg.svd(llw,full_matrices=False)
    s2=aw1s[0:64]-lls[0:64]
    s2=np.divide(s2,k)
    s2=s2/0.001
    s2=np.diag(s2)
    w1=np.matmul(wu, np.matmul(s2, wvh))
    w1=np.array(w1)
    w1=cv2.resize(w1,(64,64))
    w1=im2double(w1)
    w=im2double(w)
    data1 = ssim(w,w1)
    print(data1)
    cv2.namedWindow('Extracted watermark')
    cv2.imshow('Extracted watermark',w1)
    cv2.waitKey(0)
    cv2.destroyAllWindows()
    z=[0,0,0,0,0,0,0,0,0,0]
    z[num-1] = data1
    num=num+1
for num in range(1,11):
        sum=0
        sum=sum+z[num-1]
        print(f=1/((sum)/10-data))
        #return f


